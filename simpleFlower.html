<!DOCTYPE html>
<html>
<body>
<script type="text/javascript" src="js/phaser.min.js"></script>
<script>
    var game = new Phaser.Game(800, 640, Phaser.CANVAS, '', {preload:preload, create:create, update:update});
    var ix = 0;
    var N = 3000;
    var n = 3;
    var d = 4;
    var x = 4;
    var y = 3;
    var point;
    var scale = 50;
    var rowSize = 70;
    var colSize = 60;
    var nCol = 6;
    var nRow = 4;
    var rowOffset = 80;
    var colOffset = 1;
    var graphArray = [];
    var xAr = [];
    var yAr = [];

    var colors = ['0xf87373', '0xfc9ece', '0x12bbf0', '0xd4ac0d', '0xb177e2', '0xfa6607', '0xaadddd', '0x42b48e'];

    function preload() {

    }

    function create() {
        game.physics.startSystem(Phaser.Physics.Arcade);

        point = game.add.graphics(0, 0);

        for (var rows = 0; rows < nRow; rows++) {
            var colAr = [];
            var colArX = [];
            var colArY = [];

            for (var cols = 0; cols < nCol; cols++) {
                var graphics = game.add.graphics(colOffset + cols * colSize, rowOffset + rows * rowSize);
                colAr.push(graphics);
                colArX.push(0);
                colArY.push(0);
            }
            graphArray.push(colAr);
            xAr.push(colArX);
            yAr.push(colArY);
        }
    }

    var distanceToCenter = function(x, y) {
        return Math.sqrt(Math.pow(x * scale, 2) + Math.pow(y * scale, 2));
    };

    function update() {
        ix = ix + 1;

        for (var rows = 0; rows < nRow; rows++) {
            var colAr = graphArray[rows];
            var colArX = xAr[rows];
            var colArY = yAr[rows];

            for (var cols = 0; cols < nCol; cols++) {
                var graph = colAr[cols];
                if (ix < N) {
                    var u = ix * 21.0 * Math.PI / N;
                    var r = Math.cos(((1 + rows) / (cols)) * u);

                    if (ix > 1) {
                        graph.lineStyle(2, colors[2], 1);
                        graph.moveTo(colArX[cols] * scale + cols * colSize, colArY[cols] * scale + rows * rowSize);
                    }

                    colArX[cols] = r * Math.cos(u);
                    colArY[cols] = r * Math.sin(u);

                    if (ix > 1) {
                        graph.lineTo(colArX[cols] * scale + cols * colSize, colArY[cols] * scale + rows * rowSize);
                    }

                } else {
                    game.destroy()
                }

            }
        }

    }

</script>


</body>
</html>